<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CookSense AI</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-utensils"></i> CookSense<span>AI</span></h1>
            <p>AI 智能食譜產生器</p>
            <button id="viewSavedBtn" onclick="toggleSavedRecipes()">
                <i class="fas fa-bookmark"></i> 我的收藏 (<span id="savedCount">0</span>)
            </button>
        </header>

        <div id="savedRecipesPanel" class="hidden">
            <div class="panel-content">
                <h2><i class="fas fa-heart"></i> 已收藏的食譜</h2>
                <div id="savedList"></div>
                <button onclick="toggleSavedRecipes()" class="close-btn">關閉</button>
            </div>
        </div>

        <section class="input-panel">
            <div class="input-group full-width">
                <label>冰箱中的食材</label>
                <div class="ingredient-box">
                    <input type="text" id="ingredientInput" placeholder="輸入食材 (例如蛋、菠菜)">
                    <button id="addBtn" onclick="addIngredient()">新增</button>
                    <button id="cameraBtn">
                        <i class="fas fa-camera"></i> 上傳照片
                    </button>
                    <input type="file" id="fileInput" accept="image/*" style="display:none">
                </div>
                <div id="ingredientList" class="tags-container"></div>
            </div>

            <div class="input-group">
                <label>熱量上限 (每人/kcal)</label>
                <input type="number" id="maxCalories" placeholder="不限 (例如: 600)">
            </div>

            <section class="input-panel" style="margin-top: 30px; border-left: 5px solid #e74c3c;">
                <h2><i class="fas fa-camera-retro"></i> 飲食熱量管家</h2>
                <p>拍下你剛吃的食物，AI 幫你算還剩多少熱量額度。</p>
                
                <div style="display: flex; gap: 15px; align-items: center; margin-top: 15px;">
                    <button id="calCameraBtn" style="background: #e74c3c;">
                        <i class="fas fa-camera"></i> 上傳照片
                    </button>
                    <input type="file" id="calFileInput" accept="image/*" style="display:none">
                    
                    <div id="dailyStats" style="flex-grow: 1; text-align: right; font-weight: bold; color: #555;">
                        每日建議攝取: <span id="targetCal">--</span> kcal
                    </div>
                </div>

                <div id="calResultArea" class="hidden" style="margin-top: 20px; padding: 15px; background: #fff5f5; border-radius: 8px;">
                    <h3 id="foodName"></h3>
                    <p id="calReason" style="font-size: 0.9em; color: #666;"></p>
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 10px;">
                        <div style="font-size: 1.2em;">估算熱量: <span id="foodCal" style="color: #e74c3c; font-weight:bold;">0</span> kcal</div>
                        <div style="font-size: 1.2em;">今日剩餘: <span id="remainingCal" style="color: #27ae60; font-weight:bold;">0</span> kcal</div>
                    </div>
                </div>
            </section>

            <div class="settings-grid">
                <div class="input-group">
                    <label>廚具</label>
                    <div class="checkbox-group">
                        <label><input type="checkbox" value="stove" checked> 瓦斯爐</label>
                        <label><input type="checkbox" value="hot_plate"> 電磁爐</label>
                        <label><input type="checkbox" value="rice_cooker"> 電鍋</label>
                        <label><input type="checkbox" value="steamer"> 蒸鍋</label>
                        <label><input type="checkbox" value="oven"> 烤箱</label>
                        <label><input type="checkbox" value="microwave"> 微波爐</label>
                        <label><input type="checkbox" value="blender"> 果汁機</label>
                        <label><input type="checkbox" value="air_fryer"> 氣炸鍋</label>
                    </div>
                </div>

                <div class="input-group">
                    <label>食用者</label>
                    <select id="ageGroup">
                        <option value="younger">小孩 (口感軟/味道淡)</option>
                        <option value="adult" selected>成人 (正常)</option>
                        <option value="older">高年齡者 (低鈉/口感軟)</option>
                    </select>
                </div>

                <div class="input-group">
                    <label>料理風格</label>
                    <select id="cuisine">
                        <option value="western">西式</option>
                        <option value="chinese">中式</option>
                        <option value="japanese">日式</option>
                        <option value="korean">韓式</option>
                        <option value="italian">義式</option>
                        <option value="mexican">墨式</option>
                    </select>
                </div>

                <div class="input-group">
                    <label>人數</label>
                    <input type="number" id="peopleCount" value="2" min="1">
                </div>

                <div class="input-group full-width">
                    <label><i class="fas fa-exclamation-triangle"></i> 忌口/過敏食材 (例如：花生、海鮮)</label>
                    <input type="text" id="avoidFoods" placeholder="AI 將會自動避開這些食材">
                </div>

                <div class="input-group">
                    <label>烹飪難度</label>
                    <select id="difficulty">
                        <option value="easy">簡單 (新手友善)</option>
                        <option value="medium" selected>中等 (家常料理)</option>
                        <option value="hard">困難 (大廚挑戰)</option>
                    </select>
                </div>
            </div>

            <button id="generateBtn" onclick="generateRecipes(false)">
                <i class="fas fa-magic"></i> 用 AI 生成食譜
            </button>
        </section>

        <div id="loader" class="hidden">
            <div class="spinner"></div>
            <p>AI 正在構思食譜...</p>
        </div>

        <section id="resultsArea" class="results-grid"></section>

        <div style="text-align: center; margin-bottom: 50px;">
            <button id="loadMoreBtn" class="hidden" onclick="generateRecipes(true)">
                <i class="fas fa-plus-circle"></i> 生成更多食譜
            </button>
        </div>
    </div>
    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>